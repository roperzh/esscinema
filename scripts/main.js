window.App=window.App||{},App.Ajax={request:function(t){var e=new XMLHttpRequest;e.open(t.method,t.url,!0),e.onload=function(){e.status>=200&&e.status<400?t.success(e.response):t.error(e.response)},e.onerror=function(){t.error(e.response)},e.send()},getScript:function(t,e){var n=document.createElement("script");n.type="text/javascript",n.src=t,n.async=!0,n.onload=e,document.body.appendChild(n)}},App.FacebookSdk={load:function(t){App.Ajax.getScript("//connect.facebook.net/"+t.lang+"/all.js",function(){FB.init({appId:t.appId,xfbml:!0,version:"v2.0"})})}},App.AnalyticsSdk={load:function(t){App.Ajax.getScript("//www.google-analytics.com/ga.js",function(){_gaq.push(["_setAccount","UA-"+t.appId+"-1"]),_gaq.push(["_trackPageview"])})}},App.FacebookShare=Essential.Behavior.extend({events:{click:"share"},init:function(){this.url=this.el.getAttribute("data-share-url")},share:function(t){t.preventDefault(),FB.ui({method:"share",href:this.url},function(t){"undefined"!=typeof t&&console.log(t)})}}),App.MovieSearcher=Essential.Behavior.extend({init:function(){this.apiKey=this.el.getAttribute("data-api-key"),this.baseUrl="https://api.themoviedb.org/3/search/movie?api_key="+this.apiKey,this.template=document.getElementById("testTemplate").innerHTML,this.compiler=doT.template(this.template)},channels:{"search:textChanged #search-form":"search"},search:function(t){App.Ajax.request({url:this.baseUrl+"&query="+t.detail.text+"&search_type=ngram",method:"GET",success:this.setContents.bind(this)})},setContents:function(t){var e=JSON.parse(t);this.el.innerHTML=this.compiler(e.results),Essential.loadBehaviors({application:App,context:this.el}),this.emit({channel:"search:performed",data:{count:e.total_results}})}}),App.SearchForm=Essential.Behavior.extend({init:function(){setInterval(function(){this.didChanged&&(console.log("fired"),this.send())}.bind(this),500),this.text="padrino",this.didChanged=!0},events:{"keyup .search":"notifyTextChanged",submit:"stopSubmission"},notifyTextChanged:function(t){this.didChanged=!0,this.text=t.currentTarget.value},send:function(){this.didChanged=!1,this.emit({channel:"search:textChanged",data:{text:this.text}})},stopSubmission:function(t){t.preventDefault()}}),App.StarsRating=Essential.Behavior.extend({init:function(){this.rating=this.el.getAttribute("data-rating"),this.el.className+=" star-"+Math.round(this.rating/2)},events:{"mouseover .fa-star":"markSelection",mouseout:"reset","click .fa-star":"sendVote"},markSelection:function(t){this.setStars(t.currentTarget.dataset.index)},reset:function(){this.setStars(Math.round(this.rating/2))},setStars:function(t){this.el.className=this.el.className.replace(/star-[0-9]/,"star-"+t)},sendVote:function(t){this.rating=2*parseInt(t.currentTarget.dataset.index)}}),App.ResultBinding=Essential.Behavior.extend({channels:{"search:textChanged":"setText","search:performed":"setStat"},setText:function(t){this.el.getElementsByClassName("name")[0].innerHTML='"'+t.detail.text+'"'},setStat:function(t){this.el.getElementsByClassName("stat")[0].innerHTML=t.detail.count+" results"}}),App.TwitterShare=Essential.Behavior.extend({events:{click:"triggerClick"},triggerClick:function(t){t.preventDefault(),console.log("sadf"),window.open(t.currentTarget.getAttribute("href"),"popUpWindow","width=800,height=270,left=10,top=10")}}),App.FacebookSdk.load({appId:"271828396337653",lang:"en_UK"}),App.AnalyticsSdk.load({appId:"51741194"}),document.addEventListener("DOMContentLoaded",function(){Essential.loadBehaviors({application:App})});